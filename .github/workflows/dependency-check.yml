# .github/workflows/dependency-check.yml
# ğŸ“¦ Dependency Security Check - Ø£Ø³Ø±Ø§Ø± Ø§Ù„Ù…Ø§Ø±Ø¯ Ø§Ù„Ø±Ù‚Ù…ÙŠ Ù„Ù„Ø£Ù…Ù† Ø§Ù„Ø³ÙŠØ¨Ø±Ø§Ù†ÙŠ

name: ğŸ“¦ Dependency Security & License Check

on:
  push:
    branches:
      - main
      - develop
    paths:
      - 'package*.json'
      - 'requirements.txt'
      - 'Pipfile'
      - 'Gemfile'
      - 'go.mod'
      - 'Cargo.toml'
      - 'pom.xml'
      - 'build.gradle'
      - 'composer.json'
  pull_request:
    branches:
      - main
      - develop
    paths:
      - 'package*.json'
      - 'requirements.txt'
      - 'Pipfile'
      - 'Gemfile'
      - 'go.mod'
      - 'Cargo.toml'
      - 'pom.xml'
      - 'build.gradle'
      - 'composer.json'
  schedule:
    # ÙØ­Øµ ÙŠÙˆÙ…ÙŠ Ø§Ù„Ø³Ø§Ø¹Ø© 3 ØµØ¨Ø§Ø­Ø§Ù‹ Ø¨ØªÙˆÙ‚ÙŠØª Ø§Ù„Ù‚Ø§Ù‡Ø±Ø©
    - cron: '0 3 * * *'
  workflow_dispatch:
    inputs:
      scan_depth:
        description: 'Ø¹Ù…Ù‚ Ø§Ù„ÙØ­Øµ'
        required: true
        default: 'standard'
        type: choice
        options:
          - quick
          - standard
          - deep

concurrency:
  group: dependency-check-${{ github.ref }}
  cancel-in-progress: false

permissions:
  contents: read
  security-events: write
  pull-requests: write
  issues: write

env:
  NODE_VERSION: "20.x"
  PYTHON_VERSION: "3.11"
  GO_VERSION: "1.21"
  JAVA_VERSION: "17"
  RUBY_VERSION: "3.2"
  PHP_VERSION: "8.2"

jobs:
  # ===================================
  # ÙƒØ´Ù Ø£Ù†Ø¸Ù…Ø© Ø§Ù„ØªØ¨Ø¹ÙŠØ§Øª Ø§Ù„Ù…ÙˆØ¬ÙˆØ¯Ø©
  # ===================================
  detect-ecosystems:
    name: ğŸ” Detect Package Ecosystems
    runs-on: ubuntu-latest
    timeout-minutes: 5
    outputs:
      npm: ${{ steps.detect.outputs.npm }}
      python: ${{ steps.detect.outputs.python }}
      go: ${{ steps.detect.outputs.go }}
      ruby: ${{ steps.detect.outputs.ruby }}
      java: ${{ steps.detect.outputs.java }}
      php: ${{ steps.detect.outputs.php }}
      rust: ${{ steps.detect.outputs.rust }}
    
    steps:
      - name: ğŸ“¥ Checkout
        uses: actions/checkout@v4

      - name: ğŸ” Detect package managers
        id: detect
        run: |
          echo "Detecting package ecosystems..."
          
          # NPM/Node.js
          if [ -f "package.json" ]; then
            echo "npm=true" >> $GITHUB_OUTPUT
            echo "âœ… NPM detected"
          else
            echo "npm=false" >> $GITHUB_OUTPUT
          fi
          
          # Python
          if [ -f "requirements.txt" ] || [ -f "Pipfile" ] || [ -f "setup.py" ]; then
            echo "python=true" >> $GITHUB_OUTPUT
            echo "âœ… Python detected"
          else
            echo "python=false" >> $GITHUB_OUTPUT
          fi
          
          # Go
          if [ -f "go.mod" ]; then
            echo "go=true" >> $GITHUB_OUTPUT
            echo "âœ… Go detected"
          else
            echo "go=false" >> $GITHUB_OUTPUT
          fi
          
          # Ruby
          if [ -f "Gemfile" ]; then
            echo "ruby=true" >> $GITHUB_OUTPUT
            echo "âœ… Ruby detected"
          else
            echo "ruby=false" >> $GITHUB_OUTPUT
          fi
          
          # Java (Maven/Gradle)
          if [ -f "pom.xml" ] || [ -f "build.gradle" ]; then
            echo "java=true" >> $GITHUB_OUTPUT
            echo "âœ… Java detected"
          else
            echo "java=false" >> $GITHUB_OUTPUT
          fi
          
          # PHP
          if [ -f "composer.json" ]; then
            echo "php=true" >> $GITHUB_OUTPUT
            echo "âœ… PHP detected"
          else
            echo "php=false" >> $GITHUB_OUTPUT
          fi
          
          # Rust
          if [ -f "Cargo.toml" ]; then
            echo "rust=true" >> $GITHUB_OUTPUT
            echo "âœ… Rust detected"
          else
            echo "rust=false" >> $GITHUB_OUTPUT
          fi

  # ===================================
  # ÙØ­Øµ NPM/Node.js
  # ===================================
  npm-dependency-check:
    name: ğŸ“¦ NPM Dependencies
    runs-on: ubuntu-latest
    needs: detect-ecosystems
    if: needs.detect-ecosystems.outputs.npm == 'true'
    timeout-minutes: 20
    
    steps:
      - name: ğŸ“¥ Checkout
        uses: actions/checkout@v4

      - name: ğŸŸ¢ Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: ${{ env.NODE_VERSION }}
          cache: 'npm'

      - name: ğŸ“¦ Install dependencies
        run: npm ci --audit=false

      # NPM Audit
      - name: ğŸ” NPM Audit
        id: npm-audit
        run: |
          echo "Running npm audit..."
          npm audit --json > npm-audit.json || true
          
          # ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù†ØªØ§Ø¦Ø¬
          if [ -f "npm-audit.json" ]; then
            CRITICAL=$(cat npm-audit.json | jq '.metadata.vulnerabilities.critical // 0')
            HIGH=$(cat npm-audit.json | jq '.metadata.vulnerabilities.high // 0')
            MODERATE=$(cat npm-audit.json | jq '.metadata.vulnerabilities.moderate // 0')
            LOW=$(cat npm-audit.json | jq '.metadata.vulnerabilities.low // 0')
            
            echo "## ğŸ“Š NPM Audit Results" > npm-summary.md
            echo "" >> npm-summary.md
            echo "| Severity | Count |" >> npm-summary.md
            echo "|----------|-------|" >> npm-summary.md
            echo "| ğŸ”´ Critical | $CRITICAL |" >> npm-summary.md
            echo "| ğŸŸ  High | $HIGH |" >> npm-summary.md
            echo "| ğŸŸ¡ Moderate | $MODERATE |" >> npm-summary.md
            echo "| ğŸŸ¢ Low | $LOW |" >> npm-summary.md
            
            cat npm-summary.md
            
            # ÙØ´Ù„ Ø¥Ø°Ø§ ÙˆØ¬Ø¯Øª Ø«ØºØ±Ø§Øª Ø­Ø±Ø¬Ø©
            if [ "$CRITICAL" -gt 0 ]; then
              echo "âŒ Critical vulnerabilities found!"
              exit 1
            fi
          fi

      # Better NPM Audit
      - name: ğŸ›¡ï¸ Better NPM Audit
        uses: oke-py/npm-audit-action@v2
        with:
          audit_level: moderate
          github_token: ${{ secrets.GITHUB_TOKEN }}
          issue_assignees: asrar-mared
          issue_labels: security,dependencies,npm
          dedupe_issues: true

      # NPM Outdated
      - name: ğŸ“Š Check Outdated Packages
        run: |
          echo "Checking for outdated packages..."
          npm outdated --json > npm-outdated.json || true
          
          if [ -s npm-outdated.json ]; then
            echo "âš ï¸ Some packages are outdated:"
            cat npm-outdated.json | jq '.'
          else
            echo "âœ… All packages are up to date"
          fi

      # License Check
      - name: ğŸ“œ License Check
        run: |
          npx license-checker --json --out npm-licenses.json
          echo "ğŸ“œ License information collected"

      - name: ğŸ“¤ Upload NPM Reports
        if: always()
        uses: actions/upload-artifact@v4
        with:
          name: npm-dependency-reports
          path: |
            npm-audit.json
            npm-outdated.json
            npm-licenses.json
            npm-summary.md
          retention-days: 30

  # ===================================
  # ÙØ­Øµ Python
  # ===================================
  python-dependency-check:
    name: ğŸ Python Dependencies
    runs-on: ubuntu-latest
    needs: detect-ecosystems
    if: needs.detect-ecosystems.outputs.python == 'true'
    timeout-minutes: 20
    
    steps:
      - name: ğŸ“¥ Checkout
        uses: actions/checkout@v4

      - name: ğŸ Setup Python
        uses: actions/setup-python@v5
        with:
          python-version: ${{ env.PYTHON_VERSION }}
          cache: 'pip'

      - name: ğŸ“¦ Install tools
        run: |
          python -m pip install --upgrade pip
          pip install safety pip-audit pipdeptree piprot

      # Safety Check
      - name: ğŸ”’ Safety Check
        run: |
          echo "Running Safety check..."
          if [ -f "requirements.txt" ]; then
            safety check --file requirements.txt --json --output safety-report.json || true
            
            if [ -f "safety-report.json" ]; then
              echo "## ğŸ Safety Check Results" > python-summary.md
              cat safety-report.json | jq '.' >> python-summary.md
            fi
          fi

      # pip-audit
      - name: ğŸ›¡ï¸ pip-audit
        run: |
          echo "Running pip-audit..."
          if [ -f "requirements.txt" ]; then
            pip-audit -r requirements.txt --format json > pip-audit-report.json || true
            
            if [ -f "pip-audit-report.json" ]; then
              echo "ğŸ“Š pip-audit results:"
              cat pip-audit-report.json | jq '.'
            fi
          fi

      # Check outdated packages
      - name: ğŸ“Š Check Outdated Packages
        run: |
          echo "Checking for outdated packages..."
          pip list --outdated --format json > pip-outdated.json || true
          
          if [ -s pip-outdated.json ]; then
            echo "âš ï¸ Outdated packages found:"
            cat pip-outdated.json | jq '.'
          else
            echo "âœ… All packages are up to date"
          fi

      # Dependency Tree
      - name: ğŸŒ³ Dependency Tree
        run: |
          echo "Generating dependency tree..."
          pipdeptree --json > pip-tree.json
          pipdeptree > pip-tree.txt

      # License Check
      - name: ğŸ“œ License Check
        run: |
          pip install pip-licenses
          pip-licenses --format=json --output-file=python-licenses.json
          echo "ğŸ“œ License information collected"

      - name: ğŸ“¤ Upload Python Reports
        if: always()
        uses: actions/upload-artifact@v4
        with:
          name: python-dependency-reports
          path: |
            safety-report.json
            pip-audit-report.json
            pip-outdated.json
            pip-tree.json
            python-licenses.json
            python-summary.md
          retention-days: 30

  # ===================================
  # ÙØ­Øµ Go
  # ===================================
  go-dependency-check:
    name: ğŸ”· Go Dependencies
    runs-on: ubuntu-latest
    needs: detect-ecosystems
    if: needs.detect-ecosystems.outputs.go == 'true'
    timeout-minutes: 15
    
    steps:
      - name: ğŸ“¥ Checkout
        uses: actions/checkout@v4

      - name: ğŸ”· Setup Go
        uses: actions/setup-go@v5
        with:
          go-version: ${{ env.GO_VERSION }}
          cache: true

      - name: ğŸ“¦ Download dependencies
        run: go mod download

      - name: ğŸ” Go Vulnerability Check
        run: |
          go install golang.org/x/vuln/cmd/govulncheck@latest
          govulncheck -json ./... > go-vuln.json || true
          
          if [ -f "go-vuln.json" ]; then
            echo "ğŸ“Š Go vulnerability results:"
            cat go-vuln.json | jq '.'
          fi

      - name: ğŸ“Š Check Outdated Modules
        run: |
          go list -u -m -json all > go-modules.json
          echo "âœ… Module information collected"

      - name: ğŸ”’ Nancy (Sonatype)
        run: |
          go list -json -deps ./... | docker run --rm -i sonatypecommunity/nancy:latest sleuth > nancy-report.txt || true

      - name: ğŸ“¤ Upload Go Reports
        if: always()
        uses: actions/upload-artifact@v4
        with:
          name: go-dependency-reports
          path: |
            go-vuln.json
            go-modules.json
            nancy-report.txt
          retention-days: 30

  # ===================================
  # ÙØ­Øµ Ruby
  # ===================================
  ruby-dependency-check:
    name: ğŸ’ Ruby Dependencies
    runs-on: ubuntu-latest
    needs: detect-ecosystems
    if: needs.detect-ecosystems.outputs.ruby == 'true'
    timeout-minutes: 15
    
    steps:
      - name: ğŸ“¥ Checkout
        uses: actions/checkout@v4

      - name: ğŸ’ Setup Ruby
        uses: ruby/setup-ruby@v1
        with:
          ruby-version: ${{ env.RUBY_VERSION }}
          bundler-cache: true

      - name: ğŸ” Bundler Audit
        run: |
          gem install bundler-audit
          bundler-audit check --update > bundler-audit.txt || true
          cat bundler-audit.txt

      - name: ğŸ“Š Check Outdated Gems
        run: |
          bundle outdated --json > bundler-outdated.json || true

      - name: ğŸ“¤ Upload Ruby Reports
        if: always()
        uses: actions/upload-artifact@v4
        with:
          name: ruby-dependency-reports
          path: |
            bundler-audit.txt
            bundler-outdated.json
          retention-days: 30

  # ===================================
  # ÙØ­Øµ Java (Maven/Gradle)
  # ===================================
  java-dependency-check:
    name: â˜• Java Dependencies
    runs-on: ubuntu-latest
    needs: detect-ecosystems
    if: needs.detect-ecosystems.outputs.java == 'true'
    timeout-minutes: 20
    
    steps:
      - name: ğŸ“¥ Checkout
        uses: actions/checkout@v4

      - name: â˜• Setup Java
        uses: actions/setup-java@v4
        with:
          java-version: ${{ env.JAVA_VERSION }}
          distribution: 'temurin'
          cache: 'maven'

      - name: ğŸ” OWASP Dependency Check (Maven)
        if: hashFiles('pom.xml') != ''
        run: |
          mvn org.owasp:dependency-check-maven:check \
            -DfailBuildOnCVSS=7 \
            -DskipTestScope=true

      - name: ğŸ” Gradle Dependency Check
        if: hashFiles('build.gradle') != ''
        run: |
          ./gradlew dependencyCheckAnalyze || true

      - name: ğŸ“¤ Upload Java Reports
        if: always()
        uses: actions/upload-artifact@v4
        with:
          name: java-dependency-reports
          path: |
            target/dependency-check-report.html
            build/reports/dependency-check-report.html
          retention-days: 30

  # ===================================
  # ÙØ­Øµ PHP (Composer)
  # ===================================
  php-dependency-check:
    name: ğŸ˜ PHP Dependencies
    runs-on: ubuntu-latest
    needs: detect-ecosystems
    if: needs.detect-ecosystems.outputs.php == 'true'
    timeout-minutes: 15
    
    steps:
      - name: ğŸ“¥ Checkout
        uses: actions/checkout@v4

      - name: ğŸ˜ Setup PHP
        uses: shivammathur/setup-php@v2
        with:
          php-version: ${{ env.PHP_VERSION }}
          tools: composer

      - name: ğŸ“¦ Install dependencies
        run: composer install --no-interaction --prefer-dist

      - name: ğŸ” Composer Audit
        run: |
          composer audit --format=json > composer-audit.json || true
          cat composer-audit.json

      - name: ğŸ“Š Check Outdated Packages
        run: |
          composer outdated --format=json > composer-outdated.json || true

      - name: ğŸ“¤ Upload PHP Reports
        if: always()
        uses: actions/upload-artifact@v4
        with:
          name: php-dependency-reports
          path: |
            composer-audit.json
            composer-outdated.json
          retention-days: 30

  # ===================================
  # ÙØ­Øµ Rust (Cargo)
  # ===================================
  rust-dependency-check:
    name: ğŸ¦€ Rust Dependencies
    runs-on: ubuntu-latest
    needs: detect-ecosystems
    if: needs.detect-ecosystems.outputs.rust == 'true'
    timeout-minutes: 15
    
    steps:
      - name: ğŸ“¥ Checkout
        uses: actions/checkout@v4

      - name: ğŸ¦€ Setup Rust
        uses: actions-rs/toolchain@v1
        with:
          toolchain: stable

      - name: ğŸ” Cargo Audit
        run: |
          cargo install cargo-audit
          cargo audit --json > cargo-audit.json || true
          cat cargo-audit.json

      - name: ğŸ“Š Check Outdated Crates
        run: |
          cargo install cargo-outdated
          cargo outdated --format json > cargo-outdated.json || true

      - name: ğŸ“¤ Upload Rust Reports
        if: always()
        uses: actions/upload-artifact@v4
        with:
          name: rust-dependency-reports
          path: |
            cargo-audit.json
            cargo-outdated.json
          retention-days: 30

  # ===================================
  # ÙØ­Øµ Ø´Ø§Ù…Ù„ Ù…ØªØ¹Ø¯Ø¯ Ø§Ù„Ù„ØºØ§Øª
  # ===================================
  multi-language-check:
    name: ğŸŒ Multi-Language Dependency Check
    runs-on: ubuntu-latest
    needs: detect-ecosystems
    timeout-minutes: 30
    
    steps:
      - name: ğŸ“¥ Checkout
        uses: actions/checkout@v4

      # Trivy - ÙŠØ¯Ø¹Ù… ÙƒÙ„ Ø§Ù„Ù„ØºØ§Øª
      - name: ğŸ” Trivy Filesystem Scan
        uses: aquasecurity/trivy-action@master
        with:
          scan-type: 'fs'
          scan-ref: '.'
          format: 'sarif'
          output: 'trivy-results.sarif'
          severity: 'CRITICAL,HIGH,MEDIUM'
          vuln-type: 'library'

      - name: ğŸ“¤ Upload Trivy SARIF
        uses: github/codeql-action/upload-sarif@v3
        with:
          sarif_file: 'trivy-results.sarif'
          category: 'trivy-dependencies'

      # Snyk - ÙŠØ¯Ø¹Ù… Ù…Ø¹Ø¸Ù… Ø§Ù„Ù„ØºØ§Øª
      - name: ğŸ›¡ï¸ Snyk Test
        uses: snyk/actions/node@master
        continue-on-error: true
        env:
          SNYK_TOKEN: ${{ secrets.SNYK_TOKEN }}
        with:
          command: test
          args: --all-projects --severity-threshold=high

  # ===================================
  # ØªÙ‚Ø±ÙŠØ± Ø´Ø§Ù…Ù„ Ù„Ù„ØªØ¨Ø¹ÙŠØ§Øª
  # ===================================
  dependency-report:
    name: ğŸ“Š Dependency Summary Report
    runs-on: ubuntu-latest
    needs:
      - npm-dependency-check
      - python-dependency-check
      - go-dependency-check
      - ruby-dependency-check
      - java-dependency-check
      - php-dependency-check
      - rust-dependency-check
      - multi-language-check
    if: always()
    timeout-minutes: 10
    
    steps:
      - name: ğŸ“¥ Checkout
        uses: actions/checkout@v4

      - name: ğŸ“¥ Download All Reports
        uses: actions/download-artifact@v4
        with:
          path: dependency-reports/

      - name: ğŸ“Š Generate Summary
        run: |
          echo "# ğŸ“¦ ØªÙ‚Ø±ÙŠØ± ÙØ­Øµ Ø§Ù„ØªØ¨Ø¹ÙŠØ§Øª Ø§Ù„Ø´Ø§Ù…Ù„" > dependency-summary.md
          echo "" >> dependency-summary.md
          echo "**Ø§Ù„ØªØ§Ø±ÙŠØ®**: $(date '+%Y-%m-%d %H:%M:%S')" >> dependency-summary.md
          echo "**Ø§Ù„Ù…Ø³ØªÙˆØ¯Ø¹**: ${{ github.repository }}" >> dependency-summary.md
          echo "**Ø§Ù„ÙØ±Ø¹**: ${{ github.ref_name }}" >> dependency-summary.md
          echo "" >> dependency-summary.md
          
          echo "## ğŸ“‹ Ø£Ù†Ø¸Ù…Ø© Ø§Ù„ØªØ¨Ø¹ÙŠØ§Øª Ø§Ù„Ù…ÙƒØªØ´ÙØ©" >> dependency-summary.md
          echo "" >> dependency-summary.md
          
          if [ -d "dependency-reports/npm-dependency-reports" ]; then
            echo "- âœ… **NPM/Node.js**: ØªÙ… Ø§Ù„ÙØ­Øµ" >> dependency-summary.md
          fi
          
          if [ -d "dependency-reports/python-dependency-reports" ]; then
            echo "- âœ… **Python**: ØªÙ… Ø§Ù„ÙØ­Øµ" >> dependency-summary.md
          fi
          
          if [ -d "dependency-reports/go-dependency-reports" ]; then
            echo "- âœ… **Go**: ØªÙ… Ø§Ù„ÙØ­Øµ" >> dependency-summary.md
          fi
          
          if [ -d "dependency-reports/ruby-dependency-reports" ]; then
            echo "- âœ… **Ruby**: ØªÙ… Ø§Ù„ÙØ­Øµ" >> dependency-summary.md
          fi
          
          if [ -d "dependency-reports/java-dependency-reports" ]; then
            echo "- âœ… **Java**: ØªÙ… Ø§Ù„ÙØ­Øµ" >> dependency-summary.md
          fi
          
          if [ -d "dependency-reports/php-dependency-reports" ]; then
            echo "- âœ… **PHP**: ØªÙ… Ø§Ù„ÙØ­Øµ" >> dependency-summary.md
          fi
          
          if [ -d "dependency-reports/rust-dependency-reports" ]; then
            echo "- âœ… **Rust**: ØªÙ… Ø§Ù„ÙØ­Øµ" >> dependency-summary.md
          fi
          
          echo "" >> dependency-summary.md
          echo "## ğŸ”’ Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ©" >> dependency-summary.md
          echo "Ø¬Ù…ÙŠØ¹ ÙØ­ÙˆØµØ§Øª Ø§Ù„ØªØ¨Ø¹ÙŠØ§Øª Ù‚Ø¯ Ø§ÙƒØªÙ…Ù„Øª!" >> dependency-summary.md
          
          cat dependency-summary.md

      - name: ğŸ’¬ Comment on PR
        if: github.event_name == 'pull_request'
        uses: actions/github-script@v7
        with:
          script: |
            const fs = require('fs');
            const summary = fs.readFileSync('dependency-summary.md', 'utf8');
            
            github.rest.issues.createComment({
              issue_number: context.issue.number,
              owner: context.repo.owner,
              repo: context.repo.repo,
              body: summary
            });

      - name: ğŸ“¤ Upload Final Report
        uses: actions/upload-artifact@v4
        with:
          name: dependency-final-report
          path: |
            dependency-summary.md
            dependency-reports/
          retention-days: 90

  # ===================================
  # Ø¥Ù†Ø´Ø§Ø¡ Issue Ø¹Ù†Ø¯ ÙˆØ¬ÙˆØ¯ Ø«ØºØ±Ø§Øª Ø­Ø±Ø¬Ø©
  # ===================================
  create-security-issue:
    name: ğŸš¨ Create Security Issue
    runs-on: ubuntu-latest
    needs: dependency-report
    if: failure()
    
    steps:
      - name: ğŸš¨ Create Issue
        uses: actions/github-script@v7
        with:
          script: |
            github.rest.issues.create({
              owner: context.repo.owner,
              repo: context.repo.repo,
              title: 'ğŸš¨ Ø«ØºØ±Ø§Øª Ø£Ù…Ù†ÙŠØ© Ø­Ø±Ø¬Ø© ÙÙŠ Ø§Ù„ØªØ¨Ø¹ÙŠØ§Øª',
              body: `## ğŸš¨ ØªØ­Ø°ÙŠØ±: Ø«ØºØ±Ø§Øª Ø£Ù…Ù†ÙŠØ© Ø­Ø±Ø¬Ø©
              
              ØªÙ… Ø§ÙƒØªØ´Ø§Ù Ø«ØºØ±Ø§Øª Ø£Ù…Ù†ÙŠØ© Ø­Ø±Ø¬Ø© ÙÙŠ Ø§Ù„ØªØ¨Ø¹ÙŠØ§Øª!
              
              - **Ø§Ù„ÙØ±Ø¹**: ${context.ref}
              - **Commit**: ${context.sha}
              - **Ø§Ù„ØªØ§Ø±ÙŠØ®**: ${new Date().toISOString()}
              
              ### ğŸ”— Ø§Ù„Ø±ÙˆØ§Ø¨Ø·
              - [Ø³Ø¬Ù„Ø§Øª Workflow](${context.payload.repository.html_url}/actions/runs/${context.runId})
              - [Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ±](${context.payload.repository.html_url}/actions/runs/${context.runId}#artifacts)
              
              @asrar-mared ÙŠØ±Ø¬Ù‰ Ø§Ù„ØªØ­Ø¯ÙŠØ« Ø§Ù„ÙÙˆØ±ÙŠ Ù„Ù„ØªØ¨Ø¹ÙŠØ§Øª!`,
              labels: ['security', 'critical', 'dependencies', 'automated'],
              assignees: ['asrar-mared']
            });
